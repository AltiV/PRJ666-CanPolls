<div *ngIf="!userCanEdit && !loading" class="container unauthorized-message">
  <div class="alert alert-danger text-center">
    You cannot edit this event
  </div>
</div>
<div *ngIf="userCanEdit" class="container">
  <h2 class="text-left">Edit Event - {{event.event_title}}</h2>
  <div *ngIf="successMessage" class="alert alert-success text-center">
    Success: {{successMessage}}!
  </div>
  <form #f="ngForm" (ngSubmit)="onSubmit(f)">
    <p class="lead text-left">
      Update your Event Details
    </p>
    <div *ngIf="warning" class="alert alert-danger">
      {{warning}}
    </div>
    <div *ngFor="let err of validationErrors" class="alert alert-danger">
      {{err.msg}}
    </div>
    <div class="form-well">
      <div class="form-group row">
        <label class="col-3 col-form-label">Event Title</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="event.event_title" class="form-control" id="event_title" name="event_title">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Venue Name</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="location.venue_name" class="form-control" id="venue_name" name="venue_name">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Street Name</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="location.street_name" class="form-control" id="street_name"
            name="street_name">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">City</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="location.city" class="form-control" id="city" name="city">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Province</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="location.province" class="form-control" id="province" name="province">

        </div>
      </div>

      <div class="form-group row">
        <label class="col-3 col-form-label">Postal Code</label>
        <div class="col-9">
          <input type="text" [(ngModel)]="location.postal_code" class="form-control" id="postal_code" name="postal_code"
            maxlength="6">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Date - Time</label>
        <div class="col-9" style="display:inline-flex">

          <input type="text" [(ngModel)]="event.date_from" class="form-control" id="date_from" name="date_from">
          <input type="text" [(ngModel)]="event.time_from" class="form-control" id="time_from" name="time_from">
          <p> - </p>
          <input type="text" [(ngModel)]="event.date_to" class="form-control" id="date_to" name="date_to">
          <input type="text" [(ngModel)]="event.time_to" class="form-control" id="time_to" name="time_to">

        </div>
      </div>
      <div class="form-group row">
        <label class="image-upload-container btn btn-bwm">
          <span>Select Image</span>
          <input #imageInput type="file" accept="image/*" name="file" id="file" (change)="onFileChanged(imageInput)">
        </label>
        <div *ngIf="selectedFile" class="img-preview-container">
          <div class="img-preview" [ngStyle]="{'background-image':'url(' + selectedFile.src + ')'}">

          </div>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Attendee Limit</label>
        <div class="col-9">
          <input type="number" [(ngModel)]="event.attendee_limit" class="form-control" id="attendee_limit"
            name="attendee_limit" placeholder="put 0 for unlimited attendee" maxlength="5">

        </div>
      </div>
      <div class="form-group row">
        <label class="col-3 col-form-label">Event Description</label>
        <div class="col-9">
          <textarea [(ngModel)]="event.event_description" class="form-control" id="event_description"
            name="event_description" cols="40" rows="5"></textarea>

        </div>
      </div>
    </div>
    <div class="text-center">
      <button class="btn btn-dark btn-lg" type="submit">Submit</button>
    </div>
  </form>

  <h3 class="text-center">Registered Users</h3>
  <div class="table-responsive">
    <table class="table table-striped">
      <thead class="thead-dark">
        <th>Attendee #</th>
        <th>Username</th>
        <th>Party Affiliation</th>
        <th></th>
      </thead>
      <tbody>
        <tr *ngFor="let user of registeredUsers; index as idx">
          <td>{{idx + 1}}</td>
          <td>{{user.userName}}</td>
          <td>
            <span *ngIf="user.partyAffiliation">{{user.partyAffiliation}}</span>
            <span *ngIf="!user.partyAffiliation">None</span>
          </td>
          <td><button class="btn btn-danger text-center" (click)="removeRegisteredUser(user.userId)">Remove User</button></td>
        </tr>
      </tbody>
    </table>
  </div>
</div>